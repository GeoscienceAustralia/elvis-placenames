"use strict";angular.module("placenames.authorities",[]).directive("placenamesAuthorities",["groupsService","searchService",function(e,n){return{restrict:"EA",templateUrl:"/authorities/authorities.html",link:function(t){e.getAuthorities().then(function(e){return t.authorities=e}),t.change=function(e){n.filtered()}}}}]),angular.module("placenames.categories",[]).directive("placenamesCategories",["groupsService","searchService",function(e,n){return{templateUrl:"/categories/categories.html",link:function(t){e.getCategories().then(function(e){return t.categories=e}),t.change=function(){n.filtered()}}}}]).directive("placenamesCategoryChildren",[function(){return{templateUrl:"/categories/features.html",scope:{features:"="}}}]);var declusteredIcon=L.icon({iconUrl:"https://unpkg.com/leaflet@1.2.0/dist/images/marker-icon.png",iconRetinaUrl:"https://unpkg.com/leaflet@1.2.0/dist/images/marker-icon-2x.png",shadowUrl:"https://unpkg.com/leaflet@1.2.0/dist/images/marker-shadow.png",iconSize:[16,25],iconAnchor:[7,26],popupAnchor:[1,-22],tooltipAnchor:[10,-18],shadowSize:[25,25]});function ContributorsService(e){var t={show:!1,ingroup:!1,stick:!1};return e.get("placenames/resources/config/contributors.json").then(function(e){t.orgs=e.data}),{getState:function(){return t}}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}angular.module("placenames.contributors",[]).directive("placenamesContributors",["$interval","contributorsService",function(r,a){return{templateUrl:"/contributors/contributors.html",scope:{},link:function(e,t){var n;e.contributors=a.getState(),e.over=function(){r.cancel(n),e.contributors.ingroup=!0},e.out=function(){n=r(function(){e.contributors.ingroup=!1},1e3)},e.unstick=function(){e.contributors.ingroup=e.contributors.show=e.contributors.stick=!1,t.find("a").blur()}}}}]).directive("placenamesContributorsLink",["$interval","contributorsService",function(n,r){return{restrict:"AE",templateUrl:"/contributors/show.html",scope:{},link:function(e){var t;e.contributors=r.getState(),e.over=function(){n.cancel(t),e.contributors.show=!0},e.toggleStick=function(){e.contributors.stick=!e.contributors.stick,e.contributors.stick||(e.contributors.show=e.contributors.ingroup=!1)},e.out=function(){t=n(function(){e.contributors.show=!1},700)}}}}]).factory("contributorsService",ContributorsService).filter("activeContributors",function(){return function(e){return e?e.filter(function(e){return e.enabled}):[]}}),ContributorsService.$inject=["$http"],angular.module("placenames.autoscroll",[]).directive("autoScroll",["$timeout","$rootScope",function(p,h){return{scope:{trigger:"@",y:"@",height:"@"},link:function(o,s,c){var l,u=o.height?+o.height:100,d=u;s.on("scroll",function(e){var t,n,r=s.scrollTop(),a=s.find(c.autoScroll).height(),i=s.height();a<=i||(n=d<(t=a-r-i),(d=t)<u&&!n&&(l&&p.cancel(l),l=p(function(){h.$broadcast(o.trigger)},30)))})}}}]),angular.module("placenames.download",["placenames.zone"]).directive("placenamesDownload",["flashService","messageService","placenamesDownloadService","zoneService",function(r,a,i,n){return{templateUrl:"/download/download.html",scope:{data:"="},link:function(t){function e(e){t.processing.filename&&16<t.processing.filename.length&&(t.processing.filename=t.processing.filename.substr(0,16)),t.processing.validFilename=!t.processing.filename||t.processing.filename.match(/^[a-zA-Z0-9\_\-]+$/)}t.processing=i.data,n.counts(t.data).then(function(e){t.outCoordSys=e}),t.$watch("processing.filename",e),t.submit=function(){var n=r.add("Submitting your job for processing",null,!0);t.processing.outFormat.restrictCoordSys&&(t.processing.outCoordSys=t.processing.config.outCoordSys.find(function(e){return e.code===t.processing.outFormat.restrictCoordSys}),a.warn(t.processing.outFormat.restrictMessage)),i.submit(t.data.params).then(function(e){var t=e.data;n.remove(),"success"===t.serviceResponse.statusInfo.status?a.success("Your job has successfuly been queued for processing."):a.warn("The request has failed. Please try again later and if problems persist please contact us")}).catch(function(){n.remove(),a.warn("The request has failed. Please try again later and if problems persist please contact us")})},e()}}}]).factory("placenamesDownloadService",["$http","configService","storageService",function(a,e,t){var n="download_email",r={data:{show:!1,email:null,validFilename:!1,dataFields:"common",get valid(){return 100===this.percentComplete},get validEmail(){return this.email},get validProjection(){return this.outCoordSys},get validFormat(){return this.outFormat},get percentComplete(){return(this.validEmail?25:0)+(this.validFilename?25:0)+(this.validProjection?25:0)+(this.validFormat?25:0)}},submit:function(e){var t=e.fq,n=e.q,r={file_name:this.data.filename?this.data.filename:"output_filename",file_format_vector:this.data.outFormat.code,coord_sys:this.data.outCoordSys.code,data_fields:this.data.dataFields,email_address:this.data.email,params:{q:n,fq:t}};return this.setEmail(this.data.email),this.data.fileName&&(r.file_name=this.data.fileName),a({url:this.data.config.serviceUrl,method:"POST",headers:{"Content-Type":"application/json"},data:r})},setEmail:function(e){t.setItem(n,e)},getEmail:function(){return t.getItem(n).then(function(e){return r.data.email=e})}};return e.getConfig("download").then(function(e){return r.data.config=e}),r.getEmail().then(function(e){return r.data.email=e}),r}]).filter("productIntersect",function(){return function(e,s){return s&&e?e.filter(function(e){if(!e.extent)return!0;var t,n=e.extent,r=n.xMax,a=n.xMin,i=n.yMax,o=n.yMin;try{t=s.intersects([[o,a],[i,r]])}catch(e){return console.error("Couldn't test for intersects",e),!1}return t}):e}}),angular.module("placenames.feature",[]).directive("placenamesFeatures",["groupsService","searchService",function(e,n){return{templateUrl:"/features/features.html",link:function(t){e.getFeatures().then(function(e){return t.features=e}),t.change=function(){n.filtered()}}}}]),angular.module("placenames.feedback",[]).directive("feedback",["$window","configService",function(t,n){return{restrict:"AE",templateUrl:"/feedback/feedback.html",link:function(e){e.open=function(){n.getConfig("feedbackUrl").then(function(e){t.open(e,"_blank")})}}}}]),angular.module("placenames.tree",[]).directive("placenamesTree",["groupsService","searchService",function(e,n){return{templateUrl:"/filters/tree.html",restrict:"AE",link:function(t){e.getGroups().then(function(e){return t.groups=e}),t.change=function(e){n.filtered(),e.selected&&(e.expanded=!0)}}}}]).filter("withTotals",function(){return function(e){if(e)return e.filter(function(e){return e.total})}});var Group=function(){function e(){_classCallCheck(this,e),this.label="group",this.color="#4286f4",this._selected=!1}return _createClass(e,[{key:"selections",value:function(){var t=[];return this.selected&&(this.categories.forEach(function(e){t.push.apply(t,_toConsumableArray(e.selections()))}),!t.length)?[this]:t}},{key:"selected",get:function(){return this._selected},set:function(e){!(this._selected=e)&&this.categories&&this.categories.forEach(function(e){return e.selected=!1})}},{key:"selectExpand",get:function(){return this.selected},set:function(e){(this.selected=e)&&(this.expanded=e)}}]),e}(),Category=function(){function e(){_classCallCheck(this,e),this.label="category",this.color="#21a470",this._selected=!1}return _createClass(e,[{key:"selections",value:function(){var e=[];return this.selected&&!(e=this.features.filter(function(e){return e._selected})).length?[this]:e}},{key:"selected",get:function(){return this._selected},set:function(e){(this._selected=e)?this.parent.selected=!0:this.features&&this.features.forEach(function(e){return e.selected=!1})}},{key:"selectExpand",get:function(){return this.selected},set:function(e){(this.selected=e)&&(this.expanded=e)}}]),e}(),Feature=function(){function e(){_classCallCheck(this,e),this.label="feature",this.color="#d68a39",this._selected=!1}return _createClass(e,[{key:"selections",value:function(){return this.selected?[this]:[]}},{key:"selected",get:function(){return this._selected},set:function(e){(this._selected=e)&&(this.parent.selected=!0)}}]),e}(),createCategories=function(e){e.categories=Object.keys(e.groups)};function HelpCtrl(e,t){var n=this;e.info("HelpCtrl"),t.getFaqs().then(function(e){n.faqs=e})}function HelpService(e){return{getFaqs:function(){return e.get("placenames/resources/config/faqs.json",{cache:!0}).then(function(e){return e.data})}}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ResultsService(n,e,t,r,a,i,o){var s;return{showPan:function(e){return this.show(e).then(function(e){var t=e.map,n=t.getZoom();return t.setView(e.location,n<13?13:n,{animate:!0}),e})},clear:function(e){e.searched=null,r(function(){t.$broadcast("clear.button.fired")},10)},show:function(n){return this.hide().then(function(e){var t=n.location.split(" ").reverse().map(function(e){return+e});return{location:t,map:e,marker:s=L.popup().setLatLng(t).setContent(n.name+"<br/>Lat/Lng: "+t[0]+"&deg;"+t[1]+"&deg;").openOn(e)}})},download:function(t){this.config.then(function(e){n.get(e.esriTemplate.replace("${id}",t.join(","))).then(function(e){var t=new Blob([JSON.stringify(e,null,3)],{type:"application/json;charset=utf-8"});saveAs(t,"gazetteer-esri-features-"+Date.now()+".json")})})},hide:function(){return i.getMap().then(function(e){return s&&e.removeLayer(s),e})},get config(){return a.getConfig().then(function(e){return e.results})},moreDocs:function(e){var n,t,r;e&&((t=(n=e.data.response).docs.length)>=n.numFound||((r=e.params).start=t,o.request(r).then(function(e){var t;(t=n.docs).push.apply(t,_toConsumableArray(e.response.docs))})))}}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}angular.module("placenames.groups",["placenames.feature","placenames.categories"]).directive("placenamesGroups",["groupsService","searchService",function(e,n){return{templateUrl:"/groups/groups.html",link:function(t){e._loadGroups().then(function(e){t.data=e}),t.change=function(){console.log("Update groups"),n.filtered()}}}}]).directive("placenamesGroupChildren",["groupsService",function(e){return{templateUrl:"/groups/category.html",scope:{category:"="}}}]).factory("groupsService",["$http","$q","$rootScope","configService","mapService",function(r,e,t,n,a){var o={_loadGroups:function(){return o.config?(o.promise=null,e.when(o.config)):(o.promise||(o.promise=o.getCounts().then(function(i){return n.getConfig().then(function(t){var n=t.groups;return o.config=n,r.get(n.referenceDataLocation).then(function(e){var a=e.data;return n.data=a,n.categories=[],n.features=[],n.authorities=t.authorities,n.authorities.forEach(function(e){var t=i.authority[e.code];e.total=t||0}),n.groups=Object.keys(a).filter(function(e){return!("name"===e||"definition"===e)}).map(function(t){var e,r=new Group;return Object.assign(r,{name:t,total:i.group[t]?i.group[t]:0,definition:a[t].definition,categories:Object.keys(a[t]).filter(function(e){return!("name"===e||"definition"===e)}).map(function(e){var n=new Category;return Object.assign(n,{name:e,total:i.category[e]?i.category[e]:0,definition:a[t][e].definition,parent:r,features:a[t][e].features.map(function(e){var t=new Feature;return Object.assign(t,e,{parent:n,total:i.feature[e.name]?i.feature[e.name]:0}),t})}),n})}),(e=n.categories).push.apply(e,_toConsumableArray(r.categories)),r.categories.forEach(function(e){var t;(t=n.features).push.apply(t,_toConsumableArray(e.features))}),r}),n.authorities=n.authorities.filter(function(e){return e.total}),n.groups=n.groups.filter(function(e){return e.total}),n.categories=n.categories.filter(function(e){return e.total}),n.features=n.features.filter(function(e){return e.total}),window.larry=n.groups,n})})})),o.promise)},getCategories:function(){return o._loadGroups().then(function(){return o.config.categories})},getAll:function(){return o._loadGroups().then(function(){return o.config})},getAuthorities:function(){return o._loadGroups().then(function(){return o.config.authorities})},getGroups:function(){return o._loadGroups().then(function(){return o.config.groups})},getFeatures:function(){return o._loadGroups().then(function(){return o.config.features})},getCounts:function(){return n.getConfig("groups").then(function(e){var t=e.referenceDataCountsUrl;return r.get(t).then(function(e){var r,t=e.data.facet_counts.facet_fields,a={feature:{},category:{},group:{},authority:{}};return["feature","category","group","authority"].forEach(function(n){t[n].forEach(function(e,t){t%2?a[n][r]=e:r=e})}),a})})}};return o}]),angular.module("placenames.help",[]).directive("placenamesHelp",[function(){return{templateUrl:"/help/help.html"}}]).directive("placenamesFaqs",[function(){return{restrict:"AE",templateUrl:"/help/faqs.html",scope:{faqs:"="},link:function(e){e.focus=function(e){$("#faqs_"+e).focus()}}}}]).controller("HelpCtrl",HelpCtrl).factory("helpService",HelpService),HelpCtrl.$inject=["$log","helpService"],HelpService.$inject=["$http"],angular.module("placenames.header",[]).controller("headerController",["$scope","$q","$timeout",function(n,e,t){n.$on("headerUpdated",function(e,t){n.headerConfig=t})}]).directive("placenamesBeta",[function(){return{transclude:!0,restrict:"EA",templateUrl:"/header/beta.html"}}]).directive("placenamesHeader",[function(){var e={current:"none",heading:"ICSM",subheading:"ICSM",headingtitle:"ICSM",helpurl:"help.html",helptitle:"Get help about ICSM",helpalttext:"Get help about ICSM",skiptocontenttitle:"Skip to content",skiptocontent:"Skip to content",quicklinksurl:"/search/api/quickLinks/json?lang=en-US"};return{transclude:!0,restrict:"EA",templateUrl:"/header/header.html",scope:{current:"=",breadcrumbs:"=",heading:"=",subheading:"=",headingtitle:"=",helpurl:"=",helptitle:"=",helpalttext:"=",skiptocontenttitle:"=",skiptocontent:"=",quicklinksurl:"="},link:function(n){angular.copy(e);angular.forEach(e,function(e,t){t in n||(n[t]=e)})}}}]),angular.module("placenames.lock",[]).directive("placenamesLock",[function(){return{scope:{hover:"="},template:'<i class="fa fa-lock" aria-hidden="true" title="The features shown on the map are locked to the current search results. Clear your search results to show more features"></i>'}}]),angular.module("placenames.altthemes",["placenames.storage"]).directive("altThemes",["altthemesService",function(n){return{restrict:"AE",templateUrl:"/navigation/altthemes.html",scope:{current:"="},link:function(t){n.getThemes().then(function(e){t.themes=e}),n.getCurrentTheme().then(function(e){t.theme=e}),t.changeTheme=function(e){t.theme=e,n.setTheme(e.key)}}}}]).controller("altthemesCtrl",["altthemesService",function(e){this.service=e}]).filter("altthemesFilter",function(){return function(e,t){var n=[];return t?(e&&e.forEach(function(e){e.themes&&e.themes.some(function(e){return e===t.key})&&n.push(e)}),n):e}}).factory("altthemesService",["$q","$http","storageService",function(t,e,n){var r="placenames.current.theme",a="placenames/resources/config/themes.json",i=[],o=this;return this.themes=[],this.theme=null,n.getItem(r).then(function(n){n=n||"All",e.get(a,{cache:!0}).then(function(e){var t=e.data.themes;o.themes=t,o.theme=t[n],angular.forEach(t,function(e,t){e.key=t}),i.forEach(function(e){e.resolve(o.theme)})})}),this.getCurrentTheme=function(){if(this.theme)return t.when(o.theme);var e=t.defer();return i.push(e),e.promise},this.getThemes=function(){return e.get(a,{cache:!0}).then(function(e){return e.data.themes})},this.setTheme=function(e){this.theme=this.themes[e],n.setItem(r,e)},this}]).filter("altthemesEnabled",function(){return function(e){return e?e.filter(function(e){return!!e.enabled}):e}}).filter("altthemesMatchCurrent",function(){return function(e,t){return e?e.filter(function(e){return!!e.keys.find(function(e){return e===t})}):e}}),angular.module("placenames.navigation",["placenames.altthemes"]).directive("placenamesNavigation",[function(){return{restrict:"AE",template:"<alt-themes current='current'></alt-themes>",scope:{current:"=?"},link:function(e){e.username="Anonymous",e.current||(e.current="none")}}}]).factory("navigationService",[function(){return{}}]),angular.module("placenames.proxy",[]).provider("proxy",function(){this.$get=["$http","$q",function(r,e){var a="proxy/";return this.setProxyBase=function(e){a=e},{get:function(e,t){return this._method("get",e,t)},post:function(e,t){return this._method("post",e,t)},put:function(e,t){return this._method("put",e,t)},_method:function(e,t,n){return r[e](a+t,n).then(function(e){return e.data})}}}]}),angular.module("placenames.pill",[]).directive("placenamesPill",["searchService",function(t){return{restrict:"EA",templateUrl:"/pill/pill.html",scope:{item:"=",update:"&",name:"@?"},link:function(e){e.item.label&&(e.label=e.item.label.charAt(0).toUpperCase()+e.item.label.slice(1)+": "),e.name||(e.name="name"),e.deselect=function(){e.item.selected=!1,t.filtered()}}}}]),angular.module("placenames.quicksearch",["placenames.pill"]).directive("placenamesQuicksearch",[function(){return{link:function(){},templateUrl:"/quicksearch/quicksearch.html"}}]).directive("placenamesFilteredSummary",["searchService",function(t){return{scope:{state:"="},templateUrl:"/quicksearch/filteredsummary.html",link:function(e){e.summary=t.summary}}}]).filter("quicksummary",[function(){return function(e,t){return e.map(function(e){return e[t]+"("+e.count+")"}).join(", ")}}]),angular.module("placenames.reset",[]).directive("resetPage",function(t){return{restrict:"AE",scope:{},templateUrl:"/reset/reset.html",controller:["$scope",function(e){e.reset=function(){t.location.reload()}}]}}),angular.module("placenames.search",["placenames.authorities","placenames.groups"]).directive("placenamesClear",["searchService",function(n){return{link:function(e,t){n.onMapUpdate(function(){{var e;t.is(":focus")&&((e=$.Event("keydown")).which=27,t.trigger(e),t.blur())}})}}}]).directive("placenamesOnEnter",function(){return function(t,e,n){e.bind("keydown keypress",function(e){13===e.which&&(t.$apply(function(){t.$eval(n.placenamesOnEnter)}),e.preventDefault())})}}).directive("placenamesSearchFilters",["searchService",function(t){return{templateUrl:"/search/searchfilters.html",link:function(e){e.summary=t.summary,e.data=t.data}}}]).directive("placenamesOptions",["searchService",function(t){return{link:function(e){e.leave=function(){t.hide()},e.enter=function(){t.show(e.match.model)},e.$destroy=function(){t.hide()}}}}]).directive("placenamesQuickSearch",["$document","$rootScope","$timeout","groupsService","searchService",function(e,n,r,t,a){return{templateUrl:"/search/quicksearch.html",restrict:"AE",link:function(t){t.state=a.data,t.erase=function(){t.state.filter="",a.filtered()},e.on("keyup",function(e){27===e.which&&(e.stopPropagation(),e.preventDefault(),t.$apply(function(){t.showFilters=!1}))}),t.loadDocs=function(){return a.filtered().then(function(e){return e.response.docs})},t.clear=function(){t.state.searched=null,r(function(){n.$broadcast("clear.button.fired")},10)},t.select=function(e){t.search(e)},t.search=function(e){t.showFilters=!1,a.search(e),r(function(){n.$broadcast("search.button.fired")},100)}}}}]).directive("placenamesSearch",["$timeout","groupsService","searchService",function(e,t,n){return{templateUrl:"/search/search.html",restrict:"AE",link:function(e){e.state=n.data,e.status={},e.$watch("state.searched",function(e,t){!e&&t&&n.filtered()}),n.filtered(),e.update=function(){n.filtered()},e.loadOnEmpty=function(){e.state.filter||n.filtered()},e.deselect=function(e){e.selected=!1,n.filtered()}}}}]).filter("placenamesDocName",[function(){return function(e){return e?e.map(function(e){return e.name+" ("+e.authorityId+")"}):[]}}]).filter("placenamesSomeSelected",[function(){return function(t){return!!t&&Object.keys(t).some(function(e){return t[e].selected})}}]).filter("placenamesUnselectedFacets",[function(){return function(e){return e?e.filter(function(e){return!e.selected}):[]}}]).filter("placenamesSelectedFacets",[function(){return function(e){return e?e.filter(function(e){return e.selected}):[]}}]).filter("placenamesClean",[function(){return function(e){return e.replace(/\s?[, ]\s?/g," ")}}]).filter("placenamesTooltip",[function(){return function(e){var n,r="<div style='text-align:left'>";return e.variant&&((n=e.variant.split("|")).forEach(function(e,t){r+=t?"":"Also known as",r+=(t&&t<n.length-1?",":"")+" ",t&&t===n.length-1&&(r+="or "),r+=e}),r+="<br/>"),r+="Lat "+e.location.split(" ").reverse().join("&deg; Lng ")+"&deg;<br/>Feature type: "+e.feature+"</div>"}}]),angular.module("placenames.results.item",[]).directive("placenamesResultsItem",["placenamesItemService","placenamesResultsService","searchService",function(t,n,e){return{templateUrl:"/results/item.html",bindToController:{item:"="},controller:function(){console.log("Creating an item scope"),this.showPan=function(e){n.showPan(e)},this.download=function(e){t[e](this)},this.leave=function(){e.hide()},this.enter=function(){e.show(this.item)},this.$destroy=function(){e.hide()}},controllerAs:"vm"}}]).factory("placenamesItemService",["$http","configService",function(r,e){return{wfs:function(n){e.getConfig("results").then(function(e){var t=e.wfsTemplate;r.get(t.replace("${id}",n.item.recordId)).then(function(e){var t=new Blob([e.data],{type:"application/json;charset=utf-8"});saveAs(t,"gazetteer-wfs-feature-"+n.item.recordId+".xml")})})}}}]).filter("itemLongitude",function(){return function(e){return e.split(" ")[0]}}).filter("itemLatitude",function(){return function(e){return e.split(" ")[1]}}),angular.module("placenames.results",["placenames.results.item","placenames.scroll","placenames.download"]).directive("placenamesZoomToAll",["mapService",function(e){return{template:'<button type="button" class="map-tool-toggle-btn" ng-click="zoomToAll()" title="{{text}}"><span class="hidden-sm">{{text}}</span> <i class="fa fa-lg {{icon}}"></i></button>',scope:{center:"=",zoom:"=",bounds:"=",text:"@",icon:"@"},link:function(t){t.zoomToAll=function(){e.getMap().then(function(e){t.center&&t.zoom?e.setView(t.center,t.zoom):e.fitBounds(t.bounds)})}}}}]).directive("placenamesResultsSummary",[function(){return{templateUrl:"/results/summary.html",scope:{state:"="}}}]).directive("placenamesResultsDownload",[function(){return{template:"<placenames-download data='data'></placenames-download>",scope:{data:"="}}}]).directive("placenamesResults",["placenamesResultsService",function(t){return{templateUrl:"/results/results.html",restrict:"AE",bindToController:{data:"="},controller:function(){this.clear=function(e){this.data.searched=null},this.more=function(){t.moreDocs(this.data.persist)},this.clear=function(){t.clear(this.data)},this.download=function(){t.download(this.data.persist.data.response.docs.map(function(e){return e.id}))}},controllerAs:"pr",link:function(e){e.$destroy=function(){t.hide()},t.moreDocs(e.pr.data.persist)}}}]).factory("placenamesResultsService",ResultsService).filter("formatDate",function(){return function(e){if(!e)return e;var t=new Date(e);return t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear()}}).filter("resultsHasSomeData",function(){return function(e){return e.some(function(e){return e})}}),ResultsService.$inject=["proxy","$http","$rootScope","$timeout","configService","mapService","searchService"],angular.module("placenames.scroll",[]).directive("commonScroller",["$timeout",function(a){return{scope:{more:"&",buffer:"=?"},link:function(n,e){var r;n.buffer||(n.buffer=100),e.on("scroll",function(e){var t=e.currentTarget;a.cancel(r),r=a(function(){n.more&&t.scrollHeight-t.scrollTop<=t.clientHeight+n.buffer&&n.more()},120)})}}}]),angular.module("placenames.side-panel",[]).factory("panelSideFactory",["$rootScope","$timeout",function(n,e){var r={left:{active:null,width:0},right:{active:null,width:0}};function a(e,t){var n=e.active;return n===t?(e.active=null,e.width=0):e.active=t,!n}return{state:r,setLeft:function(e){var t=a(r.left,e);return t&&(r.left.width=320),t},setRight:function(e){r.right.width=e.width;var t=a(r.right,e.name);return n.$broadcast("side.panel.change",{side:"right",data:r.right,width:e.width}),t}}}]).directive("sidePanelRightOppose",["panelSideFactory",function(t){return{restrict:"E",transclude:!0,template:'<div class="contentContainer" ng-attr-style="right:{{right.width}}"><ng-transclude></ng-transclude></div>',link:function(e){e.right=t.state.right}}}]).directive("sidePanelRight",["panelSideFactory",function(t){return{restrict:"E",transclude:!0,templateUrl:"/side-panel/side-panel-right.html",link:function(e){e.right=t.state.right,e.closePanel=function(){t.setRight({name:null,width:0})}}}}]).directive("panelTrigger",["panelSideFactory",function(t){return{restrict:"E",transclude:!0,templateUrl:"/side-panel/trigger.html",scope:{default:"@?",panelWidth:"@",name:"@",iconClass:"@",panelId:"@"},link:function(e){e.toggle=function(){t.setRight({width:e.panelWidth,name:e.panelId})},e.default&&t.setRight({width:e.panelWidth,name:e.panelId})}}}]).directive("panelOpenOnEvent",["$rootScope","panelSideFactory",function(e,i){return{restrict:"E",scope:{panelWidth:"@",eventName:"@",panelId:"@",side:"@?"},link:function(a){a.side||(a.side="right"),e.$on(a.eventName,function(e,t){var n,r=i.state[a.side];!r||r.active&&a.panelId===r.active||(n={width:a.panelWidth,name:a.panelId},"right"===a.side?i.setRight(n):i.setLeft(n))})}}}]).directive("panelCloseOnEvent",["$rootScope","panelSideFactory",function(e,i){return{restrict:"E",scope:{eventName:"@",side:"@?"},link:function(a){a.side||(a.side="right"),e.$on(a.eventName,function(e,t){var n,r=i.state[a.side];r&&r.active&&(n={name:null},"right"===a.side?i.setRight(n):i.setLeft(n))})}}}]).directive("sidePanelLeft",["panelSideFactory",function(t){return{restrict:"E",transclude:!0,templateUrl:"/side-panel/side-panel-left.html",link:function(e){e.left=t.state.left,e.closeLeft=function(){t.setLeft(null)}}}}]),angular.module("placenames.specification",[]).directive("productSpecification",["$window","configService",function(t,n){return{restrict:"AE",templateUrl:"/specification/specification.html",link:function(e){e.openSpec=function(){n.getConfig("dataSpecificationUrl").then(function(e){t.open(e,"_blank")})}}}}]),angular.module("placenames.storage",[]).factory("storageService",["$log","$q",function(r,a){var n="elvis.placenames";return{setGlobalItem:function(e,t){this._setItem("_system",e,t)},setItem:function(e,t){this._setItem(n,e,t)},_setItem:function(e,t,n){r.debug("Fetching state for key locally"+t),localStorage.setItem(e+"."+t,JSON.stringify(n))},getGlobalItem:function(e){return this._getItem("_system",e)},getItem:function(e){var t=a.defer();return this._getItem(n,e).then(function(e){t.resolve(e)}),t.promise},_getItem:function(e,t){r.debug("Fetching state locally for key "+t);var n=localStorage.getItem(e+"."+t);if(n)try{n=JSON.parse(n)}catch(e){}return a.when(n)}}}]),angular.module("placenames.survey",[]).directive("survey",["$window","configService",function(t,n){return{restrict:"AE",templateUrl:"/survey/survey.html",link:function(e){e.openSurvey=function(){n.getConfig("surveyUrl").then(function(e){t.open(e,"_blank")})}}}}]),angular.module("placenames.restrict.pan",[]).directive("restrictPan",["mapService",function(e){return{restrict:"AE",scope:{bounds:"="},link:function(s){e.getMap().then(function(e){var t=s.bounds,n=t[0],r=t[1],a=L.latLng(n[0],n[1]),i=L.latLng(r[0],r[1]),o=L.latLngBounds(a,i);e.setMaxBounds(o),e.on("drag",function(){e.panInsideBounds(o,{animate:!1})})})}}}]),angular.module("placenames.utils",[]).filter("placenamesSplitBar",function(){return function(){var r="";return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").split("|").forEach(function(e,t,n){r+=(t&&t<n.length-1?",":"")+" ",t&&t===n.length-1&&(r+="or "),r+=e}),r}}).filter("placenamesGoogleLink",["configService",function(e){return function(e){if(!e)return"";var t=e.location.split(" ");return"https://www.google.com/maps/search/?api=1&query=${lat},${lng}".replace("${lng}",t[0]).replace("${lat}",t[1])}}]).directive("placenamesGoogleAnchor",["configService",function(e){return{scope:{linkTitle:"@",item:"="},template:'<span ng-if="hide">{{item.name}}</span><a ng-if="!hide" ng-href="{{item | placenamesGoogleLink}}" target="_google" title="{{linkTitle}}">{{item.name}}</a>',link:function(t){e.getConfig("hideGoogleLink").then(function(e){t.hide=!!e})}}}]).factory("placenamesUtilsService",["configService",function(e){return{}}]),angular.module("placenames.zone",[]).factory("zoneService",["$http","$q","configService",function(d,p,e){return{counts:function(t){var r=this;return e.getConfig("download").then(function(e){var n=e.outCoordSys;return r.intersections(t).then(function(e){var t={};return e.forEach(function(e){t[e.zone.code]=e.intersections.response.numFound}),n.forEach(function(e){e.extent&&(e.intersects=t[e.code]?t[e.code]:0)}),n.filter(function(e){return!e.extent||e.intersects})})})},intersections:function(u){return e.getConfig().then(function(e){var t=e.download.outCoordSys.filter(function(e){return e.extent}),n=u.bounds,r=u.params.q,a=n.getWest(),i=n.getEast(),o=n.getSouth(),s=n.getNorth(),c=t.filter(function(e){return a<=e.extent.xMax&&i>=e.extent.xMin&&o<=e.extent.yMax&&s>=e.extent.yMin}).map(function(e){return{zone:e,get bounds(){return{xMin:a>e.extent.xMin?a:e.extent.xMin,xMax:i<e.extent.xMax?i:e.extent.xMax,yMin:o>e.extent.yMin?o:e.extent.yMin,yMax:s<e.extent.yMax?s:e.extent.yMax}},get location(){var e=this.bounds;return"location:["+e.yMin+","+e.xMin+" TO "+e.yMax+","+e.xMax+"]"}}}),l=e.zoneQueryTemplate+"&q="+r;return p.all(c.map(function(n){return d.get(l+"&fq="+n.location).then(function(e){var t=e.data;return n.intersections=t,n})}))})}}}]);var RootCtrl=function e(t,n){var r=this;_classCallCheck(this,e),this.map=n.map,t.getConfig().then(function(e){r.data=e})};function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}RootCtrl.$invoke=["configService","mapService"],angular.module("AntarcticApp",["antarctic.australia","antarctic.clusters","antarctic.maps","antarctic.panes","antarctic.restrict.pan","antarctic.search","antarctic.searched","antarctic.templates","antarctic.toolbar","explorer.config","explorer.confirm","explorer.enter","explorer.flasher","explorer.googleanalytics","explorer.info","explorer.message","explorer.modal","explorer.persist","explorer.version","placenames.feedback","placenames.groups","placenames.header","placenames.help","placenames.lock","placenames.navigation","placenames.proxy","placenames.quicksearch","placenames.reset","placenames.search","placenames.side-panel","placenames.specification","placenames.survey","placenames.tree","placenames.utils","exp.ui.templates","ui.bootstrap","ngAutocomplete","ngSanitize","page.footer"]).config(["configServiceProvider","persistServiceProvider","projectsServiceProvider","versionServiceProvider",function(e,t,n,r){e.location("placenames/resources/config/antarctic.json?v=5"),e.dynamicLocation("placenames/resources/config/configclient.json?"),r.url("placenames/assets/package.json"),t.handler("local"),n.setProject("placenames")}]).run(["mapService","searchService",function(e,t){e.getMap(function(e){t.filtered()})}]).controller("RootCtrl",RootCtrl).filter("bytes",function(){return function(e,t){if(isNaN(parseFloat(e))||!isFinite(e))return"-";void 0===t&&(t=0);var n=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,Math.floor(n))).toFixed(t)+" "+["bytes","kB","MB","GB","TB","PB"][n]}}).factory("userService",[function(){return{login:e,hasAcceptedTerms:e,setAcceptedTerms:e,getUsername:function(){return"anon"}};function e(){return!0}}]),"every"in Array.prototype||(Array.prototype.every=function(e,t){for(var n=0,r=this.length;n<r;n++)if(n in this&&!e.call(t,this[n],n,this))return!1;return!0}),Array.from||(Array.from=function(){function u(e){return"function"==typeof e||"[object Function]"===t.call(e)}function d(e){var t,n=(t=Number(e),isNaN(t)?0:0!==t&&isFinite(t)?(0<t?1:-1)*Math.floor(Math.abs(t)):t);return Math.min(Math.max(n,0),r)}var t=Object.prototype.toString,r=Math.pow(2,53)-1;return function(e,t,n){var r=Object(e);if(null===e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var a,i=1<arguments.length?t:void 0;if(void 0!==i){if(!u(i))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(a=n)}for(var o,s=d(r.length),c=u(this)?Object(new this(s)):new Array(s),l=0;l<s;)o=r[l],c[l]=i?void 0===a?i(o,l):i.call(a,o,l):o,l+=1;return c.length=s,c}}()),angular.module("antarctic.australia",[]).directive("australiaView",function(){return{restrict:"AE",scope:{},templateUrl:"/australia/australia.html",controller:["$scope",function(e){e.go=function(){window.location="index.html"}}]}}),angular.module("antarctic.clusters",[]).directive("antarcticClusters",["clusterService",function(e){return{link:function(){e.init()}}}]).factory("clusterService",["$http","$rootScope","configService","flashService","mapService",function(a,i,e,o,s){var d={showClusters:!0,sequence:0,layer:null,cellSizes:[24,19,12,9,5,2.5,1.2,1,1,1]};return d.init=function(){var r=this;e.getConfig("clusters").then(function(t){s.getMap().then(function(e){r.map=e,r.config=t;var n=r;i.$on("pn.search.complete",function(e,t){d.timeout&&clearTimeout(d.timeout);d.timeout=setTimeout(function(){n._refreshClusters(t)},10)}),i.$on("pn.search.start",function(){n.layer&&(n.flasher=o.add("Loading features",null,!0),n.map.removeLayer(n.layer),n.layer=null)})})})},d._refreshClusters=function(t){var n=this;t.response.numFound,Object.assign({},t.responseHeader.params);function r(c){s.getMap().then(function(s){var e={q:t.responseHeader.params.q,fl:"recordId",rows:1e4,fq:getBounds(s,t.restrict),wt:"json"};a({url:"/select?",method:"GET",params:e,cache:!1}).then(function(e){var t=e.data;c.layer&&s.removeLayer(c.layer);var n,r,l,a=t.response.docs,i=s.getZoom(),o=1e5*(d.config.cellSizes?d.config.cellSizes:d.cellSizes)[i],u=(a.length,c.lookup.find(a.map(function(e){return e.recordId})));600<u.length?((n=new PolarGrid({cellWidth:o,cellHeight:o})).addPoints(u),r=Math.max.apply(Math,_toConsumableArray(n.cells.map(function(e){return e.length}))),c.layer=L.layerGroup(n.cells.map(function(e){var t='<div class="leaflet-marker-icon marker-cluster marker-cluster-{size} leaflet-zoom-animated leaflet-interactive" tabindex="0" style="transform: translate3d(-8px, -8px, 0px);"><div style="transform: translate3d(-2px, -2px, 0px);"><span>{value}</span></div></div>',n="small";return e.length>.8*r?n="large":e.length>.4*r&&(n="medium"),t=t.replace("{size}",n).replace("{value}",e.length),L.marker(e.weightedLatLng,{icon:L.divIcon({html:t})}).on("click",function(){s.setZoomAround(e.weightedLatLng,s.getZoom()+1)})})).addTo(s)):(l=c.layer=L.layerGroup(),u.forEach(function(e){var t,n=["<table class='cluster-table'>"],r=e.data,a=r.location.split(" "),i=e.latLng,o=new Date(r.supplyDate),s=o.getDate()+"/"+(o.getMonth()+1)+"/"+o.getFullYear(),c=!1;n.push("<tr><th>Name </th><td>"+r.name+"</td></tr>"),n.push("<tr><th>Feature type </th><td>"+r.feature+"</td></tr>"),n.push("<tr><th>Category </th><td>"+r.category+"</td></tr>"),n.push("<tr><th>Authority </th><td>"+r.authority+"</td></tr>"),n.push("<tr><th>Supply date</th><td>"+s+"</td></tr>"),n.push("<tr><th>Lat / Lng</th><td>"+a[1]+"° / "+a[0]+"°</td></tr>"),r.zIndexOffset=500,r.icon=declusteredIcon,t=50<u.length?L.marker(i,r):(r.radius=2,t=L.circleMarker(i,r),l.addLayer(t),L.marker(i,{icon:L.divIcon({html:"<div class='cluster-icon'><div class='ellipsis'>"+r.name+"</div></div>"})})),n.push("</table>"),t.bindPopup(n.join("")),t.on("mouseover",function(){this.openPopup()}),t.on("mouseout",function(e){c||this.closePopup()}),t.on("click",function(e){c=!0,this.openPopup()}),t.on("popupclose",function(e){c=!1}),l.addLayer(t)}),l.addTo(s)),c.flasher&&c.flasher.remove()})})}this.lookup?r(this):a.get("select?q=*:*&fq=xPolar:*&rows=10000&wt=json&fl=location,recordId,authorityId,name,feature,category,group,authority,supplyDate,xPolar,yPolar").then(function(e){var t=e.data;n.lookup=new PolarLookUp,n.lookup.addPoints(t.response.docs),r(n)})},d}]);var PolarLookUp=function(){function e(){_classCallCheck(this,e),this._points={}}return _createClass(e,[{key:"addPoint",value:function(e){var t=new PolarPoint(e);this._points[t.id]=t}},{key:"addPoints",value:function(e){var t=this;e.forEach(function(e){return t.addPoint(e)})}},{key:"find",value:function(e){var t=this;return Array.isArray(e)?e.map(function(e){return t._points[e]}):this._points[e]}},{key:"length",get:function(){return this._points.keys}}]),e}(),PolarGrid=function(){function t(e){_classCallCheck(this,t),this._options=Object.assign({cellWidth:6e5,cellHeight:6e5,crs:"EPSG:3031"},e),this._cellMap={}}return _createClass(t,[{key:"addPoint",value:function(e){var t=new Cell(this._options);t.addPoint(e),this._cellMap[t.key]?this._cellMap[t.key].addCell(t):this._cellMap[t.key]=t}},{key:"addPoints",value:function(e){var t=this;e.forEach(function(e){return t.addPoint(e)})}},{key:"cells",get:function(){return Object.entries(this._cellMap).map(function(e){return e[1]})}}]),t}(),Cell=function(){function t(e){_classCallCheck(this,t),this._points=[],this._options=e}return _createClass(t,[{key:"addPoint",value:function(e){this._weightedLatLng=this._weightedCenter=null;var t=Math.floor(e.x/this._options.cellWidth),n=Math.floor(e.y/this._options.cellHeight),r=t+"/"+n;return this._key||(this.x=t,this.y=n,this._key=r),this._key===r&&(this._points.push(e),!0)}},{key:"addCell",value:function(e){this._points=this._points.concat(e.points)}},{key:"length",get:function(){return this._points.length}},{key:"weightedCenter",get:function(){return this._weightedCenter||(this._weightedCenter={x:(this.x+.5)*this._options.cellWidth,y:(this.y+.5)*this._options.cellHeight}),this._weightedCenter}},{key:"weightedLatLng",get:function(){var e;return this._weightedLatLng||(e=this._points.reduce(function(e,t){return{lat:e.lat+t._latLng.lat,lng:e.lng+t._latLng.lng}},{lat:0,lng:0}),this._weightedLatLng={lat:e.lat/this._points.length,lng:e.lng/this._points.length}),this._weightedLatLng}},{key:"key",get:function(){return this._key}},{key:"points",get:function(){return this._points}}]),t}(),PolarPoint=function(){function n(e){_classCallCheck(this,n);var t=(this._data=e).location.split(" ");this._latLng={lat:+t[1],lng:+t[0]}}return _createClass(n,[{key:"data",get:function(){return this._data}},{key:"latLng",get:function(){return this._latLng}},{key:"id",get:function(){return this._data.recordId}},{key:"x",get:function(){return this._data.xPolar}},{key:"y",get:function(){return this._data.yPolar}},{key:"xy",get:function(){return{x:this.x,y:this.y}}}]),n}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}L.Graticule=L.GeoJSON.extend({options:{style:{color:"#333",weight:1},interval:20},initialize:function(e){L.Util.setOptions(this,e),this._layers={},this.options.sphere?this.addData(this._getFrame()):this.addData(this._getGraticule())},_getFrame:function(){return{type:"Polygon",coordinates:[this._getMeridian(-180).concat(this._getMeridian(180).reverse())]}},_getGraticule:function(){for(var e=[],t=this.options.interval,n=0;n<=180;n+=t)e.push(this._getFeature(this._getMeridian(n),{name:n?n.toString()+"° E":"Prime meridian"})),0!==n&&e.push(this._getFeature(this._getMeridian(-n),{name:n.toString()+"° W"}));for(var r=0;r<=90;r+=t)e.push(this._getFeature(this._getParallel(r),{name:r?r.toString()+"° N":"Equator"})),0!==r&&e.push(this._getFeature(this._getParallel(-r),{name:r.toString()+"° S"}));return{type:"FeatureCollection",features:e}},_getMeridian:function(e){e=this._lngFix(e);for(var t=[],n=-90;n<=90;n++)t.push([e,n]);return t},_getParallel:function(e){for(var t=[],n=-180;n<=180;n++)t.push([this._lngFix(n),e]);return t},_getFeature:function(e,t){return{type:"Feature",geometry:{type:"LineString",coordinates:e},properties:t}},_lngFix:function(e){return 180<=e?179.999999:e<=-180?-179.999999:e}}),L.graticule=function(e){return new L.Graticule(e)};var MapService=function(){function t(e){_classCallCheck(this,t),this._promise=e,this._promises=[]}return _createClass(t,[{key:"getMap",value:function(){if(this.map)return this._promise.when(this.map);var e=this._promise.defer();return this._promises.push(e),e.promise}},{key:"init",value:function(e){var t=L.bounds([-24925916.518499706,-11159088.984844638],[24925916.518499706,11159088.984844638]),n=new L.Proj.CRS("EPSG:3031","+proj=stere +lat_0=-90 +lat_ts=-71 +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs",{resolutions:[67733.46880027094,33866.73440013547,16933.367200067736,8466.683600033868,4233.341800016934,2116.670900008467,1058.3354500042335,529.1677250021168,264.5838625010584],origin:[-30636100,30636100],bounds:t});n.distance=L.CRS.Earth.distance,n.R=6378137,n.projection.bounds=t;var r=this.map=L.map(e,{center:[-70,90],zoom:2,maxZoom:8,minZoom:1,crs:n}),a=this.layer=L.tileLayer("https://tiles{s}.arcgis.com/tiles/wfNKYeHsOyaFyPw3/arcgis/rest/services/Antarctic_Hillshade_and_Bathymetric_Base_Map_SSP/MapServer/tile/{z}/{y}/{x}",{format:"image%2Fpng",tileSize:256,subdomains:"1234",noWrap:!0,continuousWorld:!0,attribution:"<a href='http://www.ga.gov.au'>Geoscience Australia</a>"}),i=a.getTileUrl,o={0:{min:1,max:2},1:{min:3,max:4},2:{min:6,max:8},3:{min:12,max:16},4:{min:24,max:32},5:{min:48,max:64},6:{min:96,max:129},7:{min:192,max:259},8:{min:385,max:519}};a.getTileUrl=function(e){var t=a._getZoomForUrl(),n=o[t].max,r=o[t].min;return e.x<r||e.y<r||e.x>n||e.y>n?"":i.call(a,e)},r.addLayer(a),window.map=r,L.control.scale({imperial:!1}).addTo(r),L.control.mousePosition({position:"bottomright",emptyString:"",seperator:" ",latFormatter:function(e){return"Lat "+L.Util.formatNum(e,5)+"°"},lngFormatter:function(e){return"Lng "+L.Util.formatNum(e%180,5)+"°"}}).addTo(r),this._promises.length&&this._promises.forEach(function(e){return e.resolve(r)}),this._promises=[]}}]),t}();function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SearchService(t,r,a,e,i,n){var o,c={searched:null},s={group:"groups",authority:"authorities",feature:"features",category:"categories"},l={},u=[],d={onMapUpdate:function(e){u.push(e)},offMapUpdate:function(e){delete u[e]},get data(){return c},get summary(){return l},filtered:function(){return f().then(function(t){return y(t).then(function(e){return d.persist(t,e),p(e.facet_counts.facet_fields),r.$broadcast("pn.search.complete",e),e})}).then(function(e){var r,n,t=(c.filtered=e).responseHeader.params;return r=t,i.getAuthorities().then(function(n){if(l.authorities&&l.authorities.length){var e={facet:!0,"facet.field":["authority"],rows:0,wt:"json"},t=v();return t.length&&(e.q+=" AND ("+t.join(" ")+")"),e.q=m(l),e.fq=r.fq,b(e).then(function(e){var t=h(e.facet_counts.facet_fields.authority);return n.forEach(function(e){e.allCount=t[e.code]}),e.facetCounts={},console.log("auth counts",e,l),e})}return n.forEach(function(e){e.allCount=l.counts.authorities[e.code]}),null}),n=t,i.getGroups().then(function(a){var e=function(e){var t={"facet.limit":-1,facet:!0,rows:0,wt:"json"};return e&&(t["facet.field"]=e),t}(["group","category","feature"]);e.q=m(l);var t=g();return t.length&&(e.q+=" AND ("+t.join(" ")+")"),e.fq=n.fq,b(e).then(function(e){var t=h(e.facet_counts.facet_fields.group),n=h(e.facet_counts.facet_fields.category),r=h(e.facet_counts.facet_fields.feature);return a.forEach(function(e){e.allCount=t[e.name],e.categories.forEach(function(e){e.allCount=n[e.name],e.features.forEach(function(e){e.allCount=r[e.name]})})}),e.facetCounts={},e})}),e})},request:b,search:function(e){var n,t=this;e?(n=e.recordId,f().then(function(t){return t.q="recordId:"+n,y(t).then(function(e){return d.persist(t,e),p(e.facet_counts.facet_fields),r.$broadcast("pn.search.complete",e),e})}).then(function(){return t.searched()})):this.searched()},persist:function(e,t){c.persist={params:e,data:t,bounds:map.getBounds()}},loadPage:function(e,t,n,r){var a=3<arguments.length&&void 0!==r?r:50,i=c.persist.params,o={fq:i.fq,rows:a,sort:i.sort,start:n,wt:"json"};o.q=m(e);var s=v();return s.length&&(o.q+=" AND ("+s.join(" ")+")"),o.q+=" AND authority:"+t.code,b(o)},searched:function(){c.searched=c.persist,c.searched.center=map.getCenter(),c.searched.zoom=map.getZoom(),c.searched.data.restrict=getEpsg3031Bounds(map),this.hide()},show:function(n){this.hide().then(function(e){var t=n.location.split(" ").reverse().map(function(e){return+e});o=L.popup().setLatLng(t).setContent(n.name+"<br/>Lat/Lng: "+t[0]+"&deg;"+t[1]+"&deg;").openOn(e)})},hide:function(){return n.getMap().then(function(e){return o&&e.removeLayer(o),e})}};function p(n){i.getAll().then(function(e){var t,r,a;l.counts=(t=n,a={},Object.values(s).forEach(function(e){a[e]={}}),Object.keys(t).forEach(function(n){t[n].forEach(function(e,t){t%2?a[s[n]][r]=e:r=e})}),a),e.authorities.forEach(function(e){e.count=l.counts.authorities[e.code],e.count=e.count?e.count:0}),["groups","features","categories"].forEach(function(t){e[t].forEach(function(e){e.count=l.counts[t][e.name],e.count=e.count?e.count:0})})})}function h(e){var n,r={};return e.forEach(function(e,t){t%2?r[n]=e:n=e}),r}function f(){return n.getMap().then(function(r){return i.getAll().then(function(e){var t="object"===_typeof(c.filter),n=d.summary;return n.filter=t?c.filter.name:c.filter,n.bounds=r.getBounds(),n.authorities=e.authorities.filter(function(e){return e.selected}),n.current=[],e.groups.forEach(function(e){return n.current=n.current.concat(e.selections())}),n})}).then(function(e){var t={"facet.limit":-1,facet:!0,"facet.field":["feature","category","authority","group"],rows:50,wt:"json"};e.bounds;t.fq=getBounds(map),t.sort="",t.q=m(e);var n=v(),r=g();return r.length&&(t.q+=" AND ("+r.join(" ")+")"),n.length&&(t.q+=" AND ("+n.join(" ")+")"),t})}function m(e){var t=e.filter;return t?'"'+t.toLowerCase()+'"':"*:*"}function g(){return l.authorities.map(function(e){return"authority:"+e.code})}function v(){return l.current.map(function(e){return e.label+':"'+e.name+'"'})}function y(e){return b(e).then(function(e){return e.facetCounts={},r.$broadcast("pn.facets.changed",e.facet_counts.facet_fields),e})}function b(e){return t({url:"/select?",method:"GET",params:e,cache:!0}).then(function(e){return e.data})}return r.$on("clear.button.fired",function(){c.searched=null,a(function(){d.filtered()},20)}),n.getMap().then(function(e){var t;function n(){r.$broadcast("pn.search.start"),a.cancel(t),c.searched?r.$broadcast("pn.search.complete",c.searched.data):(t=a(function(){d.filtered()},20),u.forEach(function(e){e()}))}(d.map=e).on("zoomend moveend resize",n),n()}),d}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function getEpsg3031Bounds(e){var t=e.getPixelBounds(),n=e.unproject(t.getBottomLeft()),r=e.unproject(t.getTopRight()),a=e.options.crs.project(r);return{sw_p:e.options.crs.project(n),ne_p:a}}function getBounds(e,t){var n,r,a,i,o=getEpsg3031Bounds(e),s=o.sw_p,c=o.ne_p;return t&&(a=s,s=(i=t.sw_p)?{x:Math.max(a.x,i.x),y:Math.max(a.y,i.y)}:a,n=c,c=(r=t.ne_p)?{x:Math.min(n.x,r.x),y:Math.min(n.y,r.y)}:n),["xPolar:["+s.x+" TO "+c.x+"]","yPolar:["+s.y+" TO "+c.y+"]"]}angular.module("antarctic.maps",[]).directive("antarcticMaps",["mapService",function(t){return{restict:"AE",template:"<div id='mappo'></div>",link:function(e){e.map=t.init("mappo")}}}]).service("mapService",["$q",function(e){return new MapService(e)}]),L.Control.MousePosition=L.Control.extend({options:{position:"bottomleft",separator:" : ",emptyString:"Unavailable",lngFirst:!1,numDigits:5,elevGetter:void 0,lngFormatter:void 0,latFormatter:void 0,prefix:""},onAdd:function(e){return this._container=L.DomUtil.create("div","leaflet-control-mouseposition"),L.DomEvent.disableClickPropagation(this._container),e.on("mousemove",this._onMouseMove,this),this._container.innerHTML=this.options.emptyString,this._container},onRemove:function(e){e.off("mousemove",this._onMouseMove)},_onMouseHover:function(){var e=this._hoverInfo;this._hoverInfo=void 0,this.options.elevGetter(e).then(function(e){this._hoverInfo||(this._container.innerHTML=this.options.prefix+" "+e+" "+this._latLngValue)}.bind(this))},_onMouseMove:function(e){var t=e.latlng.wrap(),n=this.options.lngFormatter?this.options.lngFormatter(t.lng):L.Util.formatNum(t.lng,this.options.numDigits),r=this.options.latFormatter?this.options.latFormatter(t.lat):L.Util.formatNum(t.lat,this.options.numDigits);proj4("EPSG:4326","EPSG:3031",[t.lng,t.lat]);this._latLngValue=this.options.lngFirst?n+this.options.separator+r:r+this.options.separator+n,this.options.elevGetter&&(this._hoverInfo&&window.clearTimeout(this._hoverInfo.timeout),this._hoverInfo={lat:t.lat,lng:t.lng,timeout:window.setTimeout(this._onMouseHover.bind(this),400)}),this._container.innerHTML=this.options.prefix+" "+this._latLngValue}}),L.Map.mergeOptions({positionControl:!1}),L.Map.addInitHook(function(){this.options.positionControl&&(this.positionControl=new L.Control.MousePosition,this.addControl(this.positionControl))}),L.control.mousePosition=function(e){return new L.Control.MousePosition(e)},angular.module("antarctic.restrict.pan",[]).directive("restrictPanLatitude",["mapService",function(e){return{restrict:"AE",scope:{latitude:"="},link:function(){e.getMap().then(function(e){e.on("zoomend moveend resize",function(e,t){console.log("drag/zoom",e,t)})})}}}]),angular.module("antarctic.panes",[]).directive("antarcticPanes",["$rootScope","$timeout","mapService",function(a,i,o){return{templateUrl:"/panes/panes.html",scope:{defaultItem:"@",data:"="},controller:["$scope",function(n){var r=!1;n.view=n.defaultItem,a.$on("side.panel.change",function(e){function t(){var e=document.createEvent("HTMLEvents");e.initEvent("resize",!1,!0),window.dispatchEvent(e)}t(),i(t,100),i(t,200),i(t,300),i(t,500)}),n.setView=function(e){var t=n.view;n.view===e?(e&&(r=!0),n.view=""):(e||(r=!0),n.view=e),a.$broadcast("view.changed",n.view,t),r&&o.getMap().then(function(e){e._onResize()})},i(function(){a.$broadcast("view.changed",n.view,null)},50)}]}}]),angular.module("antarctic.search",[]).factory("searchService",SearchService),SearchService.$inject=["$http","$rootScope","$timeout","configService","groupsService","mapService"],angular.module("antarctic.feature",[]).directive("antarcticFeature",["antarcticItemService","searchService",function(t,e){return{templateUrl:"/searched/feature.html",bindToController:{feature:"="},controller:function(){console.log("Creating an item scope"),this.showPan=function(e){t.showPan(e)},this.download=function(e){t[e](this)},this.leave=function(){e.hide()},this.enter=function(){e.show(this.feature)},this.$destroy=function(){e.hide()}},controllerAs:"vm"}}]).filter("formatDate",function(){return function(e){if(!e)return e;var t=new Date(e);return t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear()}}).factory("antarcticItemService",["$http","configService","mapService",function(r,e,t){var a;return{hide:function(){return t.getMap().then(function(e){return a&&e.removeLayer(a),e})},show:function(n){return this.hide().then(function(e){var t=n.location.split(" ").reverse().map(function(e){return+e});return{location:t,map:e,marker:a=L.popup().setLatLng(t).setContent(n.name+"<br/>Lat/Lng: "+t[0]+"&deg;"+t[1]+"&deg;").openOn(e)}})},wfs:function(n){e.getConfig("results").then(function(e){var t=e.wfsTemplate;r.get(t.replace("${id}",n.item.recordId)).then(function(e){var t=new Blob([e.data],{type:"application/json;charset=utf-8"});saveAs(t,"gazetteer-wfs-feature-"+n.item.recordId+".xml")})})},showPan:function(e){return this.show(e).then(function(e){var t=e.map,n=t.getZoom();return t.setView(e.location,n<8?8:n,{animate:!0}),e})}}}]).filter("itemLongitude",function(){return function(e){return e.split(" ")[0]}}).filter("itemLatitude",function(){return function(e){return e.split(" ")[1]}}),angular.module("antarctic.searched",["antarctic.feature","placenames.download"]).directive("antarcticSearched",["$rootScope","searchService",function(t,n){return{restrict:"AE",templateUrl:"/searched/searched.html",scope:{authorities:"="},link:function(e){e.data=n.data,e.summary=n.summary,t.$on("clear.button.fired",function(){e.showDownload=!1}),e.clear=function(){t.$broadcast("clear.button.fired")}}}}]).directive("placenamesZoomToAll",["mapService",function(e){return{template:'<button type="button" class="map-tool-toggle-btn" ng-click="zoomToAll()" title="{{text}}"><span class="hidden-sm">{{text}}</span> <i class="fa fa-lg {{icon}}"></i></button>',scope:{center:"=",zoom:"=",bounds:"=",text:"@",icon:"@"},link:function(t){t.zoomToAll=function(){e.getMap().then(function(e){t.center&&t.zoom?e.setView(t.center,t.zoom):e.fitBounds(t.bounds)})}}}}]).directive("antarcticSearchedSummary",[function(){return{templateUrl:"/searched/summary.html",scope:{state:"="}}}]).directive("antarcticSearchedItem",[function(){return{templateUrl:"/searched/item.html",scope:{authority:"=",feature:"="}}}]).directive("antarcticSearchedDownload",[function(){return{template:"<placenames-download data='data' class='searched-download'></placenames-download>",scope:{data:"="}}}]).directive("antarcticJurisdiction",["searchedService",function(e){return{restrict:"AE",templateUrl:"/searched/jurisdiction.html",scope:{authority:"=",item:"="},link:function(r){r.features=[],r.toggle=function(){r.showing=!r.showing,r.showing&&!r.features.length&&r.loadPage()},r.loadPage=function(){r.features.length>=r.authority.count||(r.loading=!0,e.getPage(r.authority,r.features.length).then(function(e){var t,n=e.response;r.loading=!1,(t=r.features).push.apply(t,_toConsumableArray(n.docs))}).catch(function(){r.loading=!1}))}}}}]).filter("activeAuthorities",function(){return function(e){return e.filter(function(e){return e.count})}}).factory("searchedService",["$rootScope","searchService",function(e,n){var t={data:{searched:!1},scratch:{}};return e.$on("pn.search.complete",function(e,t){0}),e.$on("search.button.fired",function(){t.data.searched=n.data.searched}),e.$on("clear.button.fired",function(){t.scratch={},delete t.data.searched}),t.getPage=function(e,t){return console.log("Paging",e,t),n.loadPage(this.data.searched,e,t)},t}]),angular.module("antarctic.toolbar",[]).directive("antarcticToolbar",[function(){return{templateUrl:"/toolbar/toolbar.html",controller:"toolbarLinksCtrl",transclude:!0}}]).controller("toolbarLinksCtrl",["$scope","configService",function(t,e){var n=this;e.getConfig().then(function(e){n.links=e.toolbarLinks}),t.item="",t.toggleItem=function(e){t.item=t.item===e?"":e}}]),angular.module("antarctic.templates",[]).run(["$templateCache",function(e){e.put("/australia/australia.html",'<button type="button" class="map-tool-toggle-btn" ng-click="go()" title="Change to the view of greater Australia">\r\n   <span>Go to Australia View</span>\r\n</button>'),e.put("/panes/panes.html",'<div class="mapContainer" class="col-md-12" style="padding-right:0">\r\n   <antarctic-maps></antarctic-maps>\r\n</div>'),e.put("/searched/feature.html",'<div ng-mouseenter="vm.enter()" ng-mouseleave="vm.leave()">\r\n      <div class="container-fluid">\r\n         <div class="row">\r\n            <div class="col-md-12 pn-header" >\r\n               <button type="button" class="undecorated" ng-click="vm.showPan(feature)"\r\n                      tooltip-append-to-body="true" title="Zoom to location." tooltip-placement="left" uib-tooltip="Zoom to location">\r\n                  <i class="fa fa-lg fa-flag-o"></i>\r\n               </button>\r\n               <span>{{feature.name}}</span>\r\n               <span class="pull-right">Record ID: {{feature.authorityId}}</span>\r\n            </div>\r\n         </div>\r\n      </div>\r\n      <div class="container-fluid">\r\n         <div class="row">\r\n            <div class="col-md-4" title="Features belong to a category and categories belong to a group">Feature Type</div>\r\n            <div class="col-md-8">{{feature.feature}}</div>\r\n         </div>\r\n         <div class="row" title="Features belong to a category and categories belong to a group">\r\n            <div class="col-md-4">Category</div>\r\n            <div class="col-md-8">{{feature.category}}</div>\r\n         </div>\r\n         <div class="row" title="Features belong to a category and categories belong to a group">\r\n            <div class="col-md-4">Group</div>\r\n            <div class="col-md-8">{{feature.group}}</div>\r\n         </div>\r\n         <div class="row">\r\n            <div class="col-md-4">Supply Date</div>\r\n            <div class="col-md-8" title="Date format is dd/mm/yyyy">{{feature.supplyDate | formatDate}}</div>\r\n         </div>\r\n         <div class="row">\r\n            <div class="col-md-4">Lat / Lng</div>\r\n            <div class="col-md-8">\r\n               <span class="pn-numeric">\r\n                  {{feature.location | itemLatitude}}&deg; / {{feature.location | itemLongitude}}&deg;\r\n               </span>\r\n            </div>\r\n         </div>\r\n\r\n      </div>'),e.put("/searched/item.html",'<div class="row">\r\n   <div class="col-md-3" style="text-align:center">\r\n      <a href="{{authority.href}}" target="_blank">\r\n         <img ng-src="{{authority.image}}" ng-attr-style="height:{{authority.height}}px">\r\n      </a>\r\n   </div>\r\n   <div class="col-md-9">\r\n      <strong ng-bind-html="authority.name"></strong>\r\n      <div>\r\n         <a ng-if="authority.metadata" ng-href="{{authority.metadata}}" target="_blank">[metadata]</a>\r\n         <a ng-if="authority.disclaimer" ng-click="authority.showDisclaimer = !authority.showDisclaimer">[disclaimer]</a>\r\n      </div>\r\n   </div>\r\n</div>\r\n<div ng-show="authority.showDisclaimer" class="searched-disclaimer" ng-bind-html="authority.disclaimer"></div>\r\n<antarctic-feature feature="item"></antarctic-feature>'),e.put("/searched/jurisdiction.html",'<div class="row">\r\n   <div class="col-md-3" style="text-align:center">\r\n      <a href="{{authority.href}}" target="_blank">\r\n         <img ng-src="{{authority.image}}" ng-attr-style="height:{{authority.height}}px">\r\n      </a>\r\n   </div>\r\n   <div class="col-md-6">\r\n      <strong ng-bind-html="authority.name"></strong>\r\n      <div>\r\n         <a ng-if="authority.metadata" ng-href="{{authority.metadata}}" target="_blank">[metadata]</a>\r\n         <a ng-if="authority.disclaimer" ng-click="authority.showDisclaimer = !authority.showDisclaimer">[disclaimer]</a>\r\n      </div>\r\n   </div>\r\n   <div class="col-md-3" style="float:right;">\r\n      ({{authority.count | number:0}} features)\r\n      <div>\r\n         <a ng-click="toggle()" class="searched-important">[{{showing?\'hide\':\'show\'}} list]</a>\r\n      </div>\r\n   </div>\r\n</div>\r\n<div ng-show="authority.showDisclaimer" class="searched-disclaimer" ng-bind-html="authority.disclaimer"></div>\r\n<div ng-show="showing">\r\n   <antarctic-feature ng-repeat="feature in features" feature="feature"></antarctic-feature>\r\n   <div class="row">\r\n      <div class="col-md-7" ng-show="authority.count > features.length">\r\n         <i style="padding:10px;" class="fa fa-spinner fa-2x fa-spin" aria-hidden="true" ng-show="loading"></i>\r\n         <a class="searched-important" ng-show="authority.count > features.length && !loading" ng-click="loadPage()">[more]</a>\r\n      </div>\r\n      <div class="col-md-7" ng-show="authority.count === features.length">\r\n         <div class="ellipsis">(End of features for {{authority.name}})</div>\r\n      </div>\r\n      <div class="col-md-5">\r\n         <span class="pull-right">\r\n            Showing {{features.length | number : 0}} of {{authority.count| number : 0}} features\r\n            <a ng-click="toggle()" class="searched-important">[hide]</a>\r\n         </span>\r\n      </div>\r\n</div>'),e.put("/searched/searched.html",'<div class="pn-results-heading" style="min-height:25px" ng-if="data.searched" ng-class="{\'searched-download\': showDownload}">\r\n   <span ng-if="data.searched.item">\r\n      Showing selected feature\r\n   </span>\r\n   <span ng-if="!data.searched.item">\r\n      Matched {{data.searched.data.response.numFound | number}} features\r\n   </span>\r\n   <span class="pull-right">\r\n      <button class="btn btn-primary" style="padding:0 10px" ng-click="showDownload = !showDownload">\r\n         <span ng-if="!showDownload">Download...</span>\r\n         <span ng-if="showDownload">Hide download details</span>\r\n      </button>\r\n      <button class="btn btn-primary" style="padding:0 10px" ng-click="clear()">\r\n         Clear results\r\n      </button>\r\n   </span>\r\n   <antarctic-search-filters></antarctic-search-filters>\r\n   <h4>Composite Gazetteer of Australia</h4>\r\n   <div style="padding-top:10px" antarctic-searched-download data="data.searched" ng-if="showDownload"></div>\r\n</div>\r\n\r\n<div ng-if="data.searched">\r\n   <div ng-if="!data.searched.item">\r\n      <div ng-repeat="authority in authorities | activeAuthorities" title="{{authority.jurisdiction}}" style="border-bottom: 1px gray solid;padding:3px 0 3px">\r\n         <antarctic-jurisdiction authority="authority"></antarctic-jurisdiction>\r\n      </div>\r\n   </div>\r\n   <div ng-if="data.searched.item">\r\n      <div ng-repeat="authority in authorities | activeAuthorities" title="{{authority.jurisdiction}}" style="border-bottom: 1px gray solid;padding:3px 0 3px">\r\n         <antarctic-searched-item authority="authority" feature="data.searched.item"></antarctic-searched-item>\r\n      </div>\r\n   </div>\r\n</div>\r\n<div ng-if="!data.searched">\r\n   <div class="panel-heading" style="min-height:25px">\r\n      <span style="font-weight:bold">\r\n         Need help on how to search?\r\n      </span>\r\n   </div>\r\n   <div class="panel-body">\r\n      Searching is conducted on the current map view. Pan and zoom the map to your area of interest\r\n      <br/>\r\n      <br/>\r\n      <span class="padding-left:5px">You can apply filters for:</span>\r\n      <div class="well">\r\n         Features matching on partial or like name, groups, categories and features.\r\n         <br/> You can restrict results to only authorities of interest.\r\n         <br/>\r\n         <br/> Once you have zoomed, panned and filtered to your desired results hit the search button to list details with\r\n         the option to download in a variety of projections and formats.\r\n         <br/>\r\n         <br/>\r\n         <b title="nota bene">NB</b> Name searching is done on "fuzzy" searching which means it isn\'t always an exact match\r\n         but a match something like what is typed.\r\n      </div>\r\n      <div>\r\n         If you are interested in features in the Antarctic consider using the\r\n         <a href="antarctic.html">search specific to the polar view</a>\r\n      </div>\r\n   </div>\r\n</div>'),e.put("/searched/summary.html",'<span class="placenamesSearchSummary"\r\n      ng-if="state.searched.data.response.numFound">(Found {{state.searched.data.response.numFound | number}} features)</span>'),e.put("/side-panel/side-panel-left.html",'<div class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-left" style="width: {{left.width}}px;" ng-class="{\'cbp-spmenu-open\': left.active}">\r\n    <a href="" title="Close panel" ng-click="closeLeft()" style="z-index: 1200">\r\n        <span class="glyphicon glyphicon-chevron-left pull-right"></span>\r\n    </a>\r\n    <div ng-show="left.active === \'legend\'" class="left-side-menu-container">\r\n        <legend url="\'img/AustralianTopogaphyLegend.png\'" title="\'Map Legend\'"></legend>\r\n    </div>\r\n</div>'),e.put("/side-panel/side-panel-right.html",'<div class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-right noPrint" ng-attr-style="width:{{right.width}}" ng-class="{\'cbp-spmenu-open\': right.active}">\r\n      <a href="" title="Close panel" ng-click="closePanel()" style="z-index: 1">\r\n          <span class="glyphicon glyphicon-chevron-right pull-left"></span>\r\n      </a>\r\n      <div ng-show="right.active === \'search\'" class="right-side-menu-container" style="z-index: 2">\r\n          <div class="panesTabContentItem" antarctic-searched authorities="authorities"></div>\r\n      </div>\r\n      <div ng-if="right.active === \'glossary\'" class="right-side-menu-container">\r\n          <div class="panesTabContentItem" placenames-glossary></div>\r\n      </div>\r\n      <div ng-show="right.active === \'help\'" class="right-side-menu-container">\r\n          <div class="panesTabContentItem" placenames-help></div>\r\n      </div>\r\n  </div>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n'),e.put("/toolbar/toolbar.html",'<div class="placenames-toolbar noPrint">\r\n    <div class="toolBarContainer">\r\n        <div>\r\n            <ul class="left-toolbar-items">\r\n               <li>\r\n                  <australia-view></australia-view>\r\n               </li>\r\n            </ul>\r\n            <ul class="right-toolbar-items">\r\n                <li>\r\n                    <panel-trigger panel-id="search" panel-width="540px" name="Search Results" icon-class="fa-list" title="When a search has completed this allows the showing and hiding of the results">\r\n                        <placenames-results-summary state="state"></placenames-results-summary>\r\n                    </panel-trigger>\r\n                </li>\r\n                <li ng-if="state.searched.data.response.numFound">\r\n                   <placenames-zoom-to-all center="state.searched.center" zoom="state.searched.zoom" bounds="state.searched.bounds" text="Show searched area" icon="fa-object-group"></placenames-zoom-to-all>\r\n                </li>\r\n                <li reset-page></li>\r\n                <li product-specification></li>\r\n                <li survey></li>\r\n                <li feedback></li>\r\n                <li>\r\n                  <panel-trigger panel-id="help" panel-width="540px" name="Help" icon-class="fa-question-circle-o" title="Show help"></panel-trigger>\r\n               </li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n</div>'),e.put("/authorities/authorities.html",'<div ng-repeat="item in authorities" style="width:49%; display:inline-block">\r\n   <div class="ellipsis" title=\'Jurisdiction: {{item.jurisdiction}}, Authority name: {{item.name}}\'>\r\n      <input type="checkbox" ng-click="update()" ng-model="item.selected" ng-change="change()">\r\n      <span>\r\n         <a target="_blank" href="http://www.google.com/search?q={{item.name}}">{{item.code}}</a>\r\n         ({{(item.allCount | number) + (item.allCount || item.allCount == 0?\' of \':\'\')}}{{item.total | number}})\r\n      </span>\r\n   </div>\r\n</div>'),e.put("/categories/categories.html",'<div>\r\n   <div ng-repeat="category in categories | orderBy: \'name\'" ng-attr-title="{{category.definition}}">\r\n      <input type="checkbox" ng-model="category.selected" ng-change="change()">\r\n      <span title="[Group: {{category.parent.name}}], {{category.definition}}">\r\n         {{category.name}}\r\n         ({{(category.allCount | number) + (category.allCount || category.allCount == 0?\' of \':\'\')}}{{category.total}})\r\n      </span>\r\n      <button class="undecorated" ng-click="category.showChildren = !category.showChildren">\r\n         <i class="fa fa-lg" ng-class="{\'fa-question-circle-o\':!category.showChildren, \'fa-minus-square-o\': category.showChildren}"></i>\r\n      </button>\r\n      <div ng-show="category.showChildren" style="padding-left: 8px; border-bottom: solid 1px lightgray">\r\n         <div>[Group: {{category.parent.name}}]\r\n         <div ng-if="category.definition">{{category.definition}}</div>\r\n         It includes the following feature types:\r\n         <placenames-category-children features="category.features"></placenames-category-children>\r\n      </div>\r\n   </div>\r\n</div>'),e.put("/categories/features.html",'<div>\n   <div ng-repeat="feature in features" style="padding-left:10px" title="{{feature.definition}}">\n      - {{feature.name}} ({{feature.total}})\n   </div>\n</div>'),e.put("/contributors/contributors.html",'<span class="contributors" ng-mouseenter="over()" ng-mouseleave="out()" style="z-index:1500"\r\n      ng-class="(contributors.show || contributors.ingroup || contributors.stick) ? \'transitioned-down\' : \'transitioned-up\'">\r\n   <button class="undecorated contributors-unstick" ng-click="unstick()" style="float:right">X</button>\r\n   <div ng-repeat="contributor in contributors.orgs | activeContributors" style="text-align:cnter">\r\n      <a ng-href="{{contributor.href}}" name="contributors{{$index}}" title="{{contributor.title}}" target="_blank">\r\n         <img ng-src="{{contributor.image}}"  alt="{{contributor.title}}" class="elvis-logo" ng-class="contributor.class"></img>\r\n      </a>\r\n   </div>\r\n</span>'),e.put("/contributors/show.html",'<a ng-mouseenter="over()" ng-mouseleave="out()" class="contributors-link" title="Click to lock/unlock contributors list."\r\n      ng-click="toggleStick()" href="#contributors0">Contributors</a>'),e.put("/download/download.html",'<div class="container-fluid">\r\n   <div class="row">\r\n      <div class="col-md-4">\r\n         <label for="geoprocessOutCoordSys">\r\n            Coordinate System\r\n         </label>\r\n      </div>\r\n      <div class="col-md-8">\r\n         <select style="width:95%" ng-model="processing.outCoordSys" id="geoprocessOutCoordSys"\r\n            ng-options="opt.value for opt in outCoordSys"></select>\r\n      </div>\r\n   </div>\r\n\r\n   <div class="row">\r\n      <div class="col-md-4">\r\n         <label for="geoprocessOutputFormat">\r\n            Output Format\r\n         </label>\r\n      </div>\r\n      <div class="col-md-8">\r\n         <select style="width:95%" ng-model="processing.outFormat" id="geoprocessOutputFormat" ng-options="opt.value for opt in processing.config.outFormat"></select>\r\n      </div>\r\n   </div>\r\n\r\n\r\n   <div class="row" title="You can elect to get common data across the authorities or for each authority receive the authorities data per feature">\r\n      <div class="col-md-4">\r\n         <label for="geoprocessDataFieldsCommon">\r\n            Data fields\r\n         </label>\r\n      </div>\r\n      <div class="col-md-8">\r\n         <label for="geoprocessDataFieldsCommon">Common fields</label>\r\n         <input type="radio" ng-model="processing.dataFields" value="common" id="geoprocessDataFieldsCommon" name="dataFields" checked="checked">\r\n         <label for="geoprocessDataFields">Authorities\' fields</label>\r\n         <input type="radio" ng-model="processing.dataFields" value="authorities" id="geoprocessDataFields" name="dataFields">\r\n      </div>\r\n   </div>\r\n\r\n   <div class="row">\r\n      <div class="col-md-4">\r\n         <label for="geoprocessOutputFormat">\r\n            File name\r\n         </label>\r\n      </div>\r\n      <div class="col-md-8">\r\n         <input type="text" ng-model="processing.filename" class="download-control" placeholder="Optional filename" title="Alphanumeric, hyphen or dash characters, maximium of 16 characters">\r\n      </div>\r\n   </div>\r\n   <div class="row">\r\n      <div class="col-md-4">\r\n         <label for="geoprocessOutputFormat">\r\n            Email\r\n         </label>\r\n      </div>\r\n      <div class="col-md-8">\r\n         <input required="required" type="email" ng-model="processing.email" class="download-control" placeholder="Email address to send download link">\r\n      </div>\r\n   </div>\r\n\r\n   <div class="row">\r\n      <div class="col-md-5" style="padding-top:7px">\r\n         <div class="progress">\r\n            <div class="progress-bar" role="progressbar" aria-valuenow="{{processing.percentComplete}}" aria-valuemin="0" aria-valuemax="100"\r\n               style="width: {{processing.percentComplete}}%;">\r\n               <span class="sr-only"></span>\r\n            </div>\r\n         </div>\r\n      </div>\r\n      <div class="col-md-5" style="padding-top:7px">\r\n         <span style="padding-right:10px" uib-tooltip="Select a valid coordinate system for area." tooltip-placement="top">\r\n            <i class="fa fa-file-video-o fa-2x" ng-class="{\'product-valid\': processing.validProjection, \'product-invalid\': !processing.validProjection}"></i>\r\n         </span>\r\n         <span style="padding-right:10px" uib-tooltip="Select a valid download format." tooltip-placement="top">\r\n            <i class="fa fa-files-o fa-2x" ng-class="{\'product-valid\': processing.validFormat, \'product-invalid\': !processing.validFormat}"></i>\r\n         </span>\r\n         <span style="padding-right:10px" uib-tooltip="Optional custom filename (alphanumeric, max length 8 characters)" tooltip-placement="top">\r\n            <i class="fa fa-save fa-2x" ng-class="{\'product-valid\': processing.validFilename, \'product-invalid\': !processing.validFilename}"></i>\r\n         </span>\r\n         <span style="padding-right:10px" uib-tooltip="Provide an email address." tooltip-placement="top">\r\n            <i class="fa fa-envelope fa-2x" ng-class="{\'product-valid\': processing.validEmail, \'product-invalid\': !processing.validEmail}"></i>\r\n         </span>\r\n      </div>\r\n      <div class="col-md-2">\r\n         <button class="btn btn-primary pull-right" ng-disabled="!processing.valid" ng-click="submit()">Submit</button>\r\n      </div>\r\n   </div>\r\n</div>'),e.put("/features/features.html",'<div>\r\n      <div ng-repeat="feature in features | orderBy: \'name\'" title="{{feature.definition}}">\r\n         <input type="checkbox" ng-model="feature.selected" ng-change="change()">\r\n         <span title="[Group/category: {{feature.parent.parent.name}}/{{feature.parent.name}}], {{feature.definition}}">\r\n            {{feature.name}} ({{(feature.allCount | number) + (feature.allCount || feature.allCount == 0?\' of \':\'\')}}{{feature.total}})\r\n         </span>\r\n         <button class="undecorated" ng-click="feature.showChildren = !feature.showChildren">\r\n            <i class="fa fa-lg" ng-class="{\'fa-question-circle-o\':!feature.showChildren, \'fa-minus-square-o\': feature.showChildren}"></i>\r\n         </button>\r\n         <div ng-show="feature.showChildren" style="padding-left: 8px; border-bottom: solid 1px lightgray">\r\n            <div ng-if="feature.definition">{{feature.definition}}</div>\r\n            [Group/Category: {{feature.parent.parent.name}}/{{feature.parent.name}}]\r\n         </div>\r\n      </div>\r\n   </div>'),e.put("/feedback/feedback.html",'<button type="button" class="map-tool-toggle-btn" ng-click="open()"\r\n   title="Provide feedback via Geoscience Australia\'s contact page.">\r\n   <span class="hidden-sm">Feedback</span>\r\n   <i class="fa fa-lg fa-comment-o"></i>\r\n</button>'),e.put("/filters/tree.html",'<div style="max-height:300px; overflow-y:auto;padding-left:10px">\r\n   <div ng-repeat="group in groups | withTotals">\r\n      <button class="undecorated" ng-click="group.expanded = !group.expanded" ng-style="{color:group.color}">\r\n         <i class="fa" ng-class="{\'fa-plus\':!group.expanded, \'fa-minus\':group.expanded}"></i>\r\n      </button>\r\n      <input type="checkbox" class="filters-check" ng-model="group.selectExpand" ng-change="change(group)" ng-style="{color:group.color}">\r\n      <span title="{{group.definition}}">\r\n         {{group.name}} ({{(group.allCount | number) + (group.allCount || group.allCount == 0?\' of \':\'\')}}{{group.total | number}})\r\n      </span>\r\n      <div style="padding-left:10px" ng-show="group.expanded">\r\n         <div ng-repeat="category in group.categories | withTotals | orderBy: \'name\'"  ng-attr-title="{{category.definition}}">\r\n            <button class="undecorated" ng-click="category.expanded = !category.expanded" ng-style="{color:category.color}">\r\n               <i class="fa" ng-class="{\'fa-plus\':!category.expanded, \'fa-minus\':category.expanded}"></i>\r\n            </button>\r\n            <input class="filters-check" type="checkbox" ng-model="category.selectExpand" ng-change="change()" ng-style="{color:category.color}">\r\n            <span title="{{category.definition}}">\r\n               {{category.name}}\r\n               ({{(category.allCount | number) + (category.allCount || category.allCount == 0?\' of \':\'\')}}{{category.total}})\r\n            </span>\r\n            <div ng-show="category.expanded" style="padding-left:20px">\r\n               <div ng-repeat="feature in category.features | withTotals | orderBy: \'name\'"  ng-attr-title="{{feature.definition}}">\r\n                  <i class="fa fa-hand-o-right" aria-hidden="true" ng-style="{color:feature.color}"></i>\r\n                  <input class="filters-check" type="checkbox" ng-model="feature.selected" ng-change="change()" ng-style="{color:feature.color}">\r\n                  <span>\r\n                     {{feature.name}}\r\n                     ({{(feature.allCount | number) + (feature.allCount || feature.allCount == 0?\' of \':\'\')}}{{feature.total}})\r\n                  </span>\r\n               </div>\r\n            </div>\r\n         </div>\r\n      </div>\r\n   </div>\r\n</div>'),e.put("/groups/category.html",'\r\n<div style="padding-left:10px">\r\n   - <span ng-attr-title="{{category.definition}}">{{category.name}}</span>\r\n   <div ng-repeat="feature in category.features | orderBy:\'name\'" style="padding-left:10px">\r\n      - <span ng-attr-title="{{feature.definition}}">{{feature.name}}</span>\r\n   </div>\r\n</div>\r\n'),e.put("/groups/groups.html",'<div>\r\n   <div ng-repeat="group in data.groups">\r\n      <input type="checkbox" ng-model="group.selected" ng-change="change()"><span title="{{group.definition}}">\r\n         {{group.name}} ({{(group.allCount | number) + (group.allCount || group.allCount == 0?\' of \':\'\')}}{{group.total | number}})\r\n      <button class="undecorated" ng-click="group.showChildren = !group.showChildren">\r\n         <i class="fa fa-lg" ng-class="{\'fa-question-circle-o\':!group.showChildren, \'fa-minus-square-o\': group.showChildren}"></i>\r\n      </button>\r\n      <div ng-show="group.showChildren" style="padding-left:8px">\r\n         {{group.definition}}<br/><br/>\r\n         This group is made up of the following categories and feature types:\r\n         <div ng-repeat="category in group.categories" style="padding-left:8px">\r\n            <placenames-group-children category="category"></placenames-group-children>\r\n         </div>\r\n      </div>\r\n   </div>\r\n</div>'),e.put("/help/faqs.html",'<p style="text-align: left; margin: 10px; font-size: 14px;">\r\n   <strong>FAQS</strong>\r\n</p>\r\n\r\n<h5 ng-repeat="faq in faqs"><button type="button" class="undecorated" ng-click="focus(faq.key)">{{faq.question}}</button></h5>\r\n<hr/>\r\n<div class="row" ng-repeat="faq in faqs">\r\n   <div class="col-md-12">\r\n      <h5 tabindex="0" id="faqs_{{faq.key}}">{{faq.question}}</h5>\r\n      <span ng-bind-html="faq.answer"></span>\r\n      <hr/>\r\n   </div>\r\n</div>'),e.put("/help/help.html",'<p style="text-align: left; margin: 10px; font-size: 14px;">\r\n\t<strong>Help</strong>\r\n</p>\r\n\r\n<div class="panel-body" ng-controller="HelpCtrl as help">\r\n\tThe steps to get data!\r\n\t<ol>\r\n\t\t<li>Define area of interest</li>\r\n\t\t<li>Select datasets</li>\r\n\t\t<li>Enter email address</li>\r\n\t\t<li>Start extract</li>\r\n\t</ol>\r\n\tAn email will be sent to you on completion of the data extract with a link to your data.\r\n   <hr>\r\n\t<placenames-faqs faqs="help.faqs" ></placenames-faqs>\r\n</div>'),e.put("/header/beta.html",'<span title="This site is a beta site"\r\n   style="background-color: orangered; padding:4px; border-radius:3px; color:white; font-size:40%; position: relative; top: -4px;">BETA</span>'),e.put("/header/header.html",'<div class="container-full common-header" style="padding-right:10px; padding-left:10px">\r\n   <div class="navbar-header">\r\n\r\n      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".ga-header-collapse">\r\n         <span class="sr-only">Toggle navigation</span>\r\n         <span class="icon-bar"></span>\r\n         <span class="icon-bar"></span>\r\n         <span class="icon-bar"></span>\r\n      </button>\r\n\r\n      <a href="/" class="appTitle visible-xs">\r\n         <h1 style="font-size:120%">{{heading}}</h1>\r\n      </a>\r\n   </div>\r\n   <div class="navbar-collapse collapse ga-header-collapse">\r\n      <ul class="nav navbar-nav">\r\n         <li class="hidden-xs">\r\n            <a href="https://www.icsm.gov.au/" target="_blank" class="icsm-logo" style="margin-top: -4px;display:inline-block;">\r\n               <img alt="ICSM - ANZLIC Committee on Surveying &amp; Mapping" class="header-logo"\r\n                  src="placenames/resources/img/icsm-logo-sml.gif">\r\n            </a>\r\n            <a href="/" style="margin-top:8px; padding:5px;display:inline-block">\r\n               <h1 class="applicationTitle">{{heading}}</h1>\r\n               <h3 ng-if="subheading" class="sub-heading">{{subheading}}</h3>\r\n            </a>\r\n         </li>\r\n      </ul>\r\n      <ul class="nav navbar-nav navbar-right nav-icons">\r\n         <li placenames-navigation role="menuitem" current="current" style="padding-right:10px"></li>\r\n         <li mars-version-display role="menuitem"></li>\r\n         <li style="width:10px"></li>\r\n      </ul>\r\n   </div>\r\n   \x3c!--/.nav-collapse --\x3e\r\n</div>\r\n<div class="contributorsLink" style="position: absolute; right:7px; bottom:25px">\r\n   <placenames-contributors-link></placenames-contributors-link>\r\n</div>\r\n\x3c!-- Strap --\x3e\r\n<div class="row">\r\n   <div class="col-md-12">\r\n      <div class="strap-blue">\r\n      </div>\r\n      <div class="strap-white">\r\n      </div>\r\n      <div class="strap-red">\r\n      </div>\r\n   </div>\r\n</div>'),e.put("/navigation/altthemes.html",'<span class="altthemes-container">\r\n\t<span ng-repeat="item in themes | altthemesMatchCurrent : current">\r\n       <a title="{{item.label}}" ng-href="{{item.url}}" class="altthemesItemCompact" target="_blank">\r\n         <span class="altthemes-icon" ng-class="item.className"></span>\r\n       </a>\r\n    </li>\r\n</span>'),e.put("/pill/pill.html",'<span class="btn btn-primary pn-pill" ng-style="item.color?{\'background-color\':item.color, \'padding-top\': \'3px\'}: {\'padding-top\': \'3px\'}">\r\n   <span style="max-width:100px;display:inline-block" title="{{label + item[name]}}" class="ellipsis">{{item[name]}}</span>\r\n   <span class="ellipsis" style="max-width:100px;display:inline-block">\r\n      ({{item.count?item.count:0 | number}})\r\n      <a ng-click="deselect()" href="javascript:void(0)" title="Remove from filters">\r\n         <i class="fa fa-close fa-xs" style="color: white"></i>\r\n      </a>\r\n   </span>\r\n</span>'),e.put("/quicksearch/filteredsummary.html",'<span class="placenames-filtered-summary-child">\r\n   <span style="font-weight:bold; margin:5px;">\r\n      Matched {{state.persist.data.response.numFound | number}}\r\n   </span>\r\n   <span ng-if="summary.authorities.length">\r\n      <span style="font-weight:bold">| For authorities:</span>\r\n      <placenames-pill ng-repeat="item in summary.authorities" name="code" item="item" update="update()"></placenames-pill>\r\n   </span>\r\n   <span ng-if="summary.current.length">\r\n      <span style="font-weight:bold"> | Filtered by {{summary.filterBy}}:</span>\r\n      <placenames-pill ng-repeat="item in summary.current" item="item" update="update()"></placenames-pill>\r\n   </span>\r\n</span>'),e.put("/quicksearch/quicksearch.html",'<div class="quickSearch" placenames-quick-search></div>\r\n'),e.put("/reset/reset.html",'<button type="button" class="map-tool-toggle-btn" ng-click="reset()" title="Reset page">\r\n   <span class="hidden-sm">Reset</span>\r\n   <i class="fa fa-lg fa-refresh"></i>\r\n</button>'),e.put("/search/quicksearch.html",'<div class="search-text">\r\n   <div class="input-group input-group-sm">\r\n      <input type="text" ng-model="state.filter" placeholder="Match by feature name..." placenames-on-enter="search()"\r\n         ng-model-options="{ debounce: 300}" typeahead-on-select="select($item, $model, $label)" typeahead-focus-first="false"\r\n         ng-disabled="state.searched" typeahead-template-url="/search/typeahead.html" class="form-control" typeahead-min-length="0"\r\n         uib-typeahead="doc as doc.name for doc in loadDocs(state.filter)" typeahead-loading="loadingLocations" typeahead-no-results="noResults"\r\n         placenames-clear>\r\n\r\n      <span class="input-group-btn">\r\n         <button class="btn btn-primary" type="button" ng-click="erase()" title="Clear typed text"\r\n            ng-hide="state.searched" id="placenamesEraseBtn">X</button>\r\n         <button class="btn btn-primary" type="button" ng-click="search()" title="Search for all features matching your search criteria"\r\n            ng-hide="state.searched" id="placenamesSearchBtn">Search</button>\r\n         <button class="btn btn-primary" type="button" ng-click="showFilters = !showFilters" ng-hide="state.searched" title="SHow/hide filters such as authority, group, category and feature type">Filters...</button>\r\n         <button class="btn btn-primary" title="Clear the current search and enable discovery" type="button" ng-click="clear()" ng-show="state.searched">Clear Search Results</button>\r\n      </span>\r\n   </div>\r\n</div>\r\n<div class="filters" ng-show="showFilters" style="background-color: white">\r\n   <div class="panel panel-default" style="margin-bottom:5px">\r\n      <div class="panel-heading">\r\n         <h4 class="panel-title">\r\n            Filter\r\n            <span ng-if="summary.current.length">ing</span> by groups/categories/features...\r\n         </h4>\r\n      </div>\r\n   </div>\r\n   <placenames-tree></placenames-tree>\r\n   <div class="panel panel-default" style="margin-bottom:5px">\r\n      <div class="panel-heading">\r\n         <h4 class="panel-title">\r\n            Filter\r\n            <span ng-if="summary.authorities.length">ing</span> by authority...\r\n         </h4>\r\n      </div>\r\n      <div style="max-height: 200px; overflow-y: auto; padding:5px">\r\n         <placenames-authorities update="update()"></placenames-authorities>\r\n      </div>\r\n   </div>\r\n</div>'),e.put("/search/search.html",'<placenames-results data="state"></placenames-results>\r\n'),e.put("/search/searchfilters.html",'<div style="padding-top:5px; padding-bottom:5px">\r\n   <span ng-if="data.filter && !data.filter.location">Matching names like "{{summary.filter}}"</span>\r\n   <span ng-if="summary.current.length">Filtered by: {{summary.current | quicksummary : "name" }}</span>\r\n   <span ng-if="summary.authorities.length">For authorities: {{summary.authorities | quicksummary : "code"}}</span>\r\n</div>'),e.put("/search/typeahead.html",'<a placenames-options ng-mouseenter="enter()" ng-mouseleave="leave()"  tooltip-append-to-body="true"\r\n               tooltip-placement="bottom" uib-tooltip-html="match.model | placenamesTooltip">\r\n   <span ng-bind-html="match.model.name | uibTypeaheadHighlight:query"></span>\r\n   (<span ng-bind-html="match.model.authorityId"></span>)\r\n</a>'),e.put("/results/item.html",'<div ng-mouseenter="vm.enter()" ng-mouseleave="vm.leave()">\r\n<div class="container-fluid">\r\n   <div class="row">\r\n      <div class="col-md-12 pn-header" >\r\n         <button type="button" class="undecorated" ng-click="vm.showPan(vm.item)"\r\n                tooltip-append-to-body="true" title="Zoom to location." tooltip-placement="left" uib-tooltip="Zoom to location">\r\n            <i class="fa fa-lg fa-flag-o"></i>\r\n         </button>\r\n         <span><placenames-google-anchor item="vm.item"\r\n            link-title="View in Google maps. While the location will always be correct, Google will do a best guess at matching the Gazetteer name to its data."></placenames-google-anchor></span>\r\n         <span class="pull-right">Record ID: {{vm.item.authorityId}}</span>\r\n      </div>\r\n   </div>\r\n</div>\r\n<div class="container-fluid">\r\n   <div class="row">\r\n      <div class="col-md-4"  title="An authority can be a state department or other statutory authority">Authority</div>\r\n      <div class="col-md-8">{{vm.item.authority}}</div>\r\n   </div>\r\n   <div class="row">\r\n      <div class="col-md-4" title="Features belong to a category and categories belong to a group">Feature Type</div>\r\n      <div class="col-md-8">{{vm.item.feature}}</div>\r\n   </div>\r\n   <div class="row" title="Features belong to a category and categories belong to a group">\r\n      <div class="col-md-4">Category</div>\r\n      <div class="col-md-8">{{vm.item.category}}</div>\r\n   </div>\r\n   <div class="row" title="Features belong to a category and categories belong to a group">\r\n      <div class="col-md-4">Group</div>\r\n      <div class="col-md-8">{{vm.item.group}}</div>\r\n   </div>\r\n   <div class="row">\r\n      <div class="col-md-4">Supply Date</div>\r\n      <div class="col-md-8" title="Date format is dd/mm/yyyy">{{vm.item.supplyDate | formatDate}}</div>\r\n   </div>\r\n   <div class="row">\r\n      <div class="col-md-4">Lat / Lng</div>\r\n      <div class="col-md-8">\r\n         <span class="pn-numeric">\r\n            {{vm.item.location | itemLatitude}}&deg; / {{vm.item.location | itemLongitude}}&deg;\r\n         </span>\r\n      </div>\r\n   </div>\r\n\r\n</div>'),e.put("/results/results.html",'<div class="pn-results-heading" style="min-height:25px" ng-if="pr.data.searched">\r\n   <span ng-if="pr.data.searched.item">\r\n      Showing selected feature\r\n   </span>\r\n   <span ng-if="!pr.data.searched.item">\r\n      Matched {{pr.data.searched.data.response.numFound | number}} features\r\n      <span ng-if="!pr.data.searched.item && pr.data.searched.data.response.numFound > pr.data.searched.data.response.docs.length">, showing {{pr.data.searched.data.response.docs.length | number}}</span>\r\n      <a href="javascript:void()" ng-if="!pr.data.searched.item && pr.data.searched.data.response.numFound > pr.data.searched.data.response.docs.length"\r\n         ng-click="pr.more()" tooltip-placement="bottom" uib-tooltip="Scroll to the bottom of results or click here to load more matching features">\r\n         [Load more]\r\n      </a>\r\n   </span>\r\n   <span class="pull-right">\r\n      <button class="btn btn-primary" style="padding:0 10px" ng-click="pr.showDownload = !pr.showDownload">\r\n         <span ng-if="!pr.showDownload">Download...</span>\r\n         <span ng-if="pr.showDownload">Hide download details</span>\r\n      </button>\r\n      <button class="btn btn-primary" style="padding:0 10px" ng-if="!pr.data.searched.item && !pr.showDownload" ng-click="pr.clear()">\r\n         Clear results\r\n      </button>\r\n   </span>\r\n</div>\r\n<div class="panel panel-default pn-container" ng-if="pr.data.searched" common-scroller buffer="200" more="pr.more()">\r\n   <div class="panel-heading">\r\n      <placenames-search-filters ng-if="pr.data.searched"></placenames-search-filters>\r\n      <placenames-results-item ng-if="pr.data.searched.item" item="pr.data.searched.item"></placenames-results-item>\r\n      <placenames-results-download data="pr.data.searched" ng-if="!pr.data.searched.item && pr.showDownload"></placenames-results-download>\r\n      <div class="pn-results-list" ng-if="!pr.data.searched.item" ng-repeat="doc in pr.data.searched.data.response.docs">\r\n         <placenames-results-item item="doc"></placenames-results-item>\r\n      </div>\r\n   </div>\r\n</div>\r\n<div class="panel panel-default pn-container" ng-if="!pr.data.searched">\r\n   <div class="panel-heading" style="min-height:25px">\r\n      <span style="font-weight:bold">\r\n         Need help on how to search?\r\n      </span>\r\n   </div>\r\n   <div class="panel-body">\r\n      Searching is conducted on the current map view. Pan and zoom the map to your area of interest\r\n      <br/>\r\n      <br/>\r\n      <span class="padding-left:5px">You can apply filters for:</span>\r\n      <div class="well">\r\n         Features matching on partial or like name, groups, categories and features.\r\n         <br/> You can restrict results to only authorities of interest.\r\n         <br/>\r\n         <br/> Once you have zoomed, panned and filtered to your desired results hit the search button to list details with the\r\n         option to download in a variety of projections and formats.\r\n         <br/>\r\n         <br/>\r\n         <b title="nota bene">NB</b> Name searching is done on "fuzzy" searching which means it isn\'t always an exact match but a match something\r\n         like what is typed.\r\n\r\n      </div>\r\n      <div>\r\n         If you are interested in features in the Antarctic consider using the\r\n         <a href="antarctic.html">search specific to the polar view</a>\r\n      </div>\r\n   </div>\r\n</div>'),e.put("/results/summary.html",'<span class="placenamesSearchSummary"\r\n      ng-if="state.searched.data.response.numFound">(Found {{state.searched.data.response.numFound | number}} features)</span>'),e.put("/side-panel/trigger.html",'<button ng-click="toggle()" type="button" class="map-tool-toggle-btn">\r\n   <span class="hidden-sm">{{name}}</span>\r\n   <ng-transclude></ng-transclude>\r\n   <i class="fa fa-lg" ng-class="iconClass"></i>\r\n</button>'),e.put("/specification/specification.html",'<button type="button" class="map-tool-toggle-btn" ng-click="openSpec()" title="View data product specification (opens new page)">\r\n      <span class="hidden-sm">Data Product Specification</span>\r\n      <i class="fa fa-lg fa-book"></i>\r\n   </button>'),e.put("/survey/survey.html",'<button type="button" class="map-tool-toggle-btn" ng-click="openSurvey()"\n   title="Complete a user survey on your experience with Placenames">\n   <span class="hidden-sm">User Survey</span>\n   <span class="fa-stack fa-lg">\n    <i class="fa fa-wpforms fa-stack-1x"></i>\n    <i class="fa fa-edit fa-stack-1x"></i>\n  </span>\n</button>')}]);